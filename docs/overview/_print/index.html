<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.83.1"><link rel=canonical type=text/html href=https://enricovianello.github.io/storm-docs/docs/overview/><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/storm-docs/favicons/favicon.ico><link rel=apple-touch-icon href=/storm-docs/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/storm-docs/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/storm-docs/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/storm-docs/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/storm-docs/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/storm-docs/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/storm-docs/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/storm-docs/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/storm-docs/favicons/android-192x192.png sizes=192x192><title>StoRM Architecture Overview | StoRM</title><meta property="og:title" content="StoRM Architecture Overview"><meta property="og:description" content="StoRM is a storage resource manager for disk based storage systems
"><meta property="og:type" content="website"><meta property="og:url" content="https://enricovianello.github.io/storm-docs/docs/overview/"><meta property="og:site_name" content="StoRM"><meta itemprop=name content="StoRM Architecture Overview"><meta itemprop=description content="StoRM is a storage resource manager for disk based storage systems
"><meta name=twitter:card content="summary"><meta name=twitter:title content="StoRM Architecture Overview"><meta name=twitter:description content="StoRM is a storage resource manager for disk based storage systems
"><link rel=preload href=/storm-docs/scss/main.min.e8d637f30893e85918b2aeae9cd9eab6c68fcd7998810e804d7c9ab542fbfd45.css as=style><link href=/storm-docs/scss/main.min.e8d637f30893e85918b2aeae9cd9eab6c68fcd7998810e804d7c9ab542fbfd45.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/storm-docs/><span class=navbar-logo></span><span class="text-uppercase font-weight-bold">StoRM</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/storm-docs/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/storm-docs/releases/><span>Releases</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/storm-docs/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/storm-docs/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/storm-docs/about/><span>About us</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/storm-docs/offline-search-index.b7611a06b9258cf32f97250541075b89.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"></div><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/storm-docs/docs/overview/>Return to the regular view of this page</a>.</p></div><h1 class=title>StoRM Architecture Overview</h1><div class=lead>StoRM is a storage resource manager for disk based storage systems</div><ul><li>1: <a href=#pg-31b6c27d462384edee7d1984c9032d2e>StoRM Backend</a></li><li>2: <a href=#pg-3f40f484569fc9bf98e20d2726aae6eb>StoRM Frontend</a></li><li>3: <a href=#pg-dfb81697b72608d6c0b1ef6c31877426>StoRM GridFTP DSI plugin</a></li><li>4: <a href=#pg-80d93e211efdd1e8ecac27df30eff2ea>StoRM WebDAV</a></li></ul><div class=content><p>StoRM is a lightweight storage resource manager (SRM) solution developed at <a href=https://home.infn.it/it/>INFN</a>, which powers the Italian Tier-1 data center at <a href=https://www.cnaf.infn.it/>INFN-CNAF</a>, as well as more than 30 other sites.</p><p>The SRM (&ldquo;Storage Resource Manager&rdquo;) is a protocol for Storage Resource Management. The SRM protocol does not do any data transfer. The protocol is used to ask a Mass Storage System (MSS) to make a file ready for transfer, or to create space in a disk cache to which a file can be uploaded. The file is then transferred to or from a Transfer URL or TURL.</p><p><em>Read more:</em></p><ul><li><a href=https://sdm.lbl.gov/srm-wg/doc/SRM.v2.2.html>The Storage Resource Manager Interface Specification Version 2.2</a></li></ul><h2 id=storm-typical-deployment>StoRM typical deployment</h2><p>StoRM implements the <a href=https://sdm.lbl.gov/srm-wg/doc/SRM.v2.2.html>SRM version 2.2</a> data management specification and is typically deployed on top of a cluster file system like <a href=https://www.ibm.com/docs/en/gpfs>IBM GPFS</a>. StoRM has a layered architecture (Figure 1), split between two main components: the StoRM frontend and backend services. The StoRM frontend service implements the SRM interface exposed to client applications and frameworks. The StoRM backend service implements the actual storage management logic by interacting directly with the underlying file system. Data transfer is provided by GridFTP, HTTP/WebDAV and XRootD services accessing directly the file system underlying the StoRM deployment. StoRM WebDAV, besides HTTP data transfer functionality, also provides a WebDAV-based data management interface.</p><p>StoRM supports tape through integration with GEMSS, a tape library manager component also developed at INFN-CNAF.</p><p><img src=/storm-docs/images/storm-architecture.png alt="StoRM typical deployment architecture" title="Figure 1. StoRM typical deployment architecture"></p><p>StoRM provides flexible AuthN/Z support:</p><ul><li>VOMS & OAuth tokens (WebDAV & CDMI)</li><li>File access control is enforced via POSIX ACLs</li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-31b6c27d462384edee7d1984c9032d2e>1 - StoRM Backend</h1><div class=lead>The Backend is the core of SRM implementation and REST services. It executes all SRM functionalities, it takes care of file and space metadata management, enforces authorization permissions on files and interacts with external Grid services.</div><p>The StoRM Backend component has several responsabilities:</p><ul><li>executes all synchronous (active) actions</li><li>retrieves asynchronous request from the database</li><li>executes all asynchronous actions</li><li>binds with underlying file systems</li><li>enforces authorization policy on files</li><li>manages SRM file and space metadata</li></ul><h2 id=internal-macro-components>Internal macro components</h2><p>StoRM Backend has the following internal macro components:</p><ul><li>Asynchronous SRM requests manager</li><li>Synchronous SRM requests manager</li><li>XML-RPC server</li><li>Persistence manager</li><li>Namespace component</li><li>Autorization component</li><li>Filesystem manager</li></ul><h2 id=srm-requests-from-database>SRM requests from database</h2><p>The Picker component retrieves the specified amount of new SRM requests from the Database at each time interval, and forward them to a Scheduler. The Scheduler takes care of forward the request to the right worker thread as a new task to be executed. The request status is updated into the Database with all the information concerining request results, error and other data. This data are accessible from the FE to answer to a srmStatusOf* request. This pattern is shown in the following picture:</p><p><img src=/storm-docs/images/reqfromdb.png alt="Retrieving new SRM requests from database." title="Figure 1. Retrieving new SRM requests from database."></p><p>Most of the parameters characterizing this architecture are configurable.</p><h2 id=file-system-driver>File System driver</h2><p>StoRM interacts with the different file systems supported through a driver mechanism. Each driver is a native library written mainly in C/C++, since most of the file system provides C libraries for the advanced API. StoRM Backend uses JNI to connect with drivers. The functionalities provided by each driver are:</p><ul><li>ACL management</li><li>Space management</li></ul><p>The drivers available with StoRM are:</p><ul><li><em>posixfs</em> generic driver for posix file system. It relies on the standard <code>setfacl()</code>, <code>getfacl()</code> syscall for ACL management, and it does not provide any advanced space management capabilities.</li><li><em>GPFS</em> specific driver that relies on GPFS advanced API, such as <code>gpfs_prealloc</code> for space management and <code>gpfs_set_acl()</code> for ACL management.</li></ul><p>This driver mechanism implements a common interface and decouple StoRM internal logic from the different functionalities provided by the underlying storage system. The drivers are loaded at run time following the storage namespace configuration. A single StoRM server is able to work on different file system at the same time, and with this flexible approach it can be easily adapted to support new kind of file systems or other storage resources.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-3f40f484569fc9bf98e20d2726aae6eb>2 - StoRM Frontend</h1><div class=lead>The Frontend component exposes the SRM web service interface, manages user authentication and stores the data of the SRM requests into the database. It relies on the GSOAP framework to expose the SRM interface and it uses the CGSI-GSOAP plugin to manage secure connection with clients.</div><h3 id=pool-of-worker-threads>Pool of worker threads</h3><p>The FE uses a pool of worker threads to manage SRM requests. Once a request has been authorized, the FE assigns it as a new task for a worker thread. In case there are no free threads in the system, the request is maintained in an internal queue. The size of the pool and the size of the queue are important parameters, their value have to be defined depending on hardware resources and performance required. Depending on the type of SRM request, each thread should have two main task to do, as explained in the next paragraph.</p><h3 id=xml-rpc-communication>XML-RPC communication</h3><p>Synchronous SRM requests are a category of SRM calls that return the control to the client only when the request has been executed by the system. Most of the SRM call belongs to this category:</p><ul><li>Namespace operations (srmLs, srmMkdir, etc.)</li><li>Discovery operation (srmPing)</li><li>Space operations (srmReserveSpace, srmGetSpaceMetadata, etc.)</li></ul><p>For this type of request, the FE perform a direct communication to the Backend using a RPC approach, based on the XML-RPC protocol. XML-RPC is a simple protocol to exchange XML structured data over HTTP. The Backend provides an XML-RPC server and the FE(s) acts as client. A worker threads in case of synchronous requests performs this steps:</p><ul><li>structure the SRM data in XML</li><li>send a request to the BE XML-RPC server</li><li>wait until the execution</li><li>get result from XML and unmarshall it in SOAP</li><li>return the control to the client</li></ul><img src=/images/fe-architecture.jpg width=400 style=margin-top:30px;margin-bottom:30px></div><div class=td-content style=page-break-before:always><h1 id=pg-dfb81697b72608d6c0b1ef6c31877426>3 - StoRM GridFTP DSI plugin</h1><div class=lead>The GridFTP DSI plugin is &mldr;</div><div class="pageinfo pageinfo-primary"><p>This is a placeholder page. Replace it with your own content.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-80d93e211efdd1e8ecac27df30eff2ea>4 - StoRM WebDAV</h1><div class=lead>StoRM WebDAV is &mldr;</div><div class="pageinfo pageinfo-primary"><p>This is a placeholder page. Replace it with your own content.</p></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="StoRM users mailing list" aria-label="StoRM users mailing list"><a class=text-white target=_blank rel="noopener noreferrer" href=https://lists.infn.it/sympa/info/storm-users><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel="noopener noreferrer" href=https://github.com/italiangrid/storm><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel="noopener noreferrer" href=https://infn-storm-support.slack.com/><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="StoRM developers mailing list" aria-label="StoRM developers mailing list"><a class=text-white target=_blank rel="noopener noreferrer" href=https://lists.infn.it/sympa/info/storm-devel><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2021 INFN All Rights Reserved</small><p class=mt-2><a href=/storm-docs/about/>About us</a></p></div></div></div></footer></div><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=/storm-docs/js/main.min.63db3e552bd0543be17ce4a79a18b744e9cb72256bec42b540e3ab0cd43722d0.js integrity="sha256-Y9s+VSvQVDvhfOSnmhi3ROnLciVr7EK1QOOrDNQ3ItA=" crossorigin=anonymous></script></body></html>