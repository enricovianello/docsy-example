<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.83.1"><meta name=ROBOTS content="NOINDEX, NOFOLLOW"><link rel="shortcut icon" href=/storm-docs/favicons/favicon.ico><link rel=apple-touch-icon href=/storm-docs/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/storm-docs/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/storm-docs/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/storm-docs/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/storm-docs/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/storm-docs/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/storm-docs/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/storm-docs/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/storm-docs/favicons/android-192x192.png sizes=192x192><title>StoRM v1.11.20 could break connections with MariaDB | StoRM</title><meta property="og:title" content="StoRM v1.11.20 could break connections with MariaDB"><meta property="og:description" content="After the update from StoRM v1.11.19 to StoRM v1.11.20, if JVM and database are not on the same timezone, the Backend’s communication with MariaDB could start failing.
"><meta property="og:type" content="article"><meta property="og:url" content="https://enricovianello.github.io/storm-docs/blog/2021/04/30/storm-v1.11.20-could-break-connections-with-mariadb/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-04-30T00:00:00+00:00"><meta property="article:modified_time" content="2021-06-28T12:07:30+02:00"><meta property="og:site_name" content="StoRM"><meta itemprop=name content="StoRM v1.11.20 could break connections with MariaDB"><meta itemprop=description content="After the update from StoRM v1.11.19 to StoRM v1.11.20, if JVM and database are not on the same timezone, the Backend’s communication with MariaDB could start failing.
"><meta itemprop=datePublished content="2021-04-30T00:00:00+00:00"><meta itemprop=dateModified content="2021-06-28T12:07:30+02:00"><meta itemprop=wordCount content="336"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="StoRM v1.11.20 could break connections with MariaDB"><meta name=twitter:description content="After the update from StoRM v1.11.19 to StoRM v1.11.20, if JVM and database are not on the same timezone, the Backend’s communication with MariaDB could start failing.
"><link rel=preload href=/storm-docs/scss/main.min.e8d637f30893e85918b2aeae9cd9eab6c68fcd7998810e804d7c9ab542fbfd45.css as=style><link href=/storm-docs/scss/main.min.e8d637f30893e85918b2aeae9cd9eab6c68fcd7998810e804d7c9ab542fbfd45.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script></head><body class="td-page td-blog"><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/storm-docs/><span class=navbar-logo></span><span class="text-uppercase font-weight-bold">StoRM</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/storm-docs/blog/><span class=active>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/storm-docs/releases/><span>Releases</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/storm-docs/docs/><span>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/storm-docs/community/><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/storm-docs/about/><span>About us</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/storm-docs/offline-search-index.3177d5bbc5f920d7e7d5a2255c1cefae.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center d-lg-none"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/storm-docs/offline-search-index.3177d5bbc5f920d7e7d5a2255c1cefae.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/storm-docs/blog/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Blog</a></li><ul><li class="collapse show" id=storm-docsblog><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/storm-docs/blog/news/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">News</a></li><ul><li class="collapse show" id=storm-docsblognews><a class="td-sidebar-link td-sidebar-link__page active" id=m-storm-docsblog20210430storm-v11120-could-break-connections-with-mariadb href=/storm-docs/blog/2021/04/30/storm-v1.11.20-could-break-connections-with-mariadb/>StoRM v1.11.20 known issue</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-storm-docsblog20181006easy-documentation-with-docsy href=/storm-docs/blog/2018/10/06/easy-documentation-with-docsy/>Announcing Docsy</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/storm-docs/blog/releases/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Releases</a></li><ul><li class=collapse id=storm-docsblogreleases><a class="td-sidebar-link td-sidebar-link__page" id=m-storm-docsblog20210512released-storm-v11121 href=/storm-docs/blog/2021/05/12/released-storm-v1.11.21/>StoRM v1.11.21</a>
<a class="td-sidebar-link td-sidebar-link__page" id=m-storm-docsblog20180104another-great-release href=/storm-docs/blog/2018/01/04/another-great-release/>Release New Features</a></li></ul></ul></li></ul></ul></nav></div></div><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/enricovianello/docsy-example/edit/storm/content/en/blog/news/storm-v1.11.20-known-issue.md target=_blank><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/enricovianello/docsy-example/new/storm/content/en/blog/news/storm-v1.11.20-known-issue.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/enricovianello/docsy-example/issues/new?title=StoRM%20v1.11.20%20could%20break%20connections%20with%20MariaDB" target=_blank><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/google/docsy/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
<a id=print href=https://enricovianello.github.io/storm-docs/blog/news/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><nav id=TableOfContents><ul><li><ul><li><a href=#downgrade-storm-backend-to-v11119>Downgrade StoRM Backend to v1.11.19</a></li><li><a href=#apply-a-workaround-within-mariadb>Apply a workaround within MariaDB</a></li><li><a href=#install-storm-backend-v11121-beta>Install StoRM Backend v1.11.21 beta</a></li></ul></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role=main><div class=td-content><h1>StoRM v1.11.20 could break connections with MariaDB</h1><div class=lead>After the update from StoRM v1.11.19 to StoRM v1.11.20, if JVM and database are not on the same timezone, the Backend’s communication with MariaDB could start failing.</div><div class="td-byline mb-4"><time datetime=2021-04-30 class=text-muted>Friday, April 30, 2021</time></div><p>After the update from StoRM v1.11.19 to StoRM v1.11.20, if JVM and database are not on the same timezone, the Backend&rsquo;s communication with MariaDB could start failing with the following error:</p><pre><code>Caused by: java.sql.SQLException: The server time zone value 'CEST' is unrecognized or represents more than one time zone. You must configure either the server or JDBC driver (via the serverTimezone configuration property) to use a more specifc time zone value if you want to utilize time zone support.
</code></pre><p>This bug is tracked at <a href=https://issues.infn.it/jira/browse/STOR-1397>STOR-1397</a>.</p><p>The possible solutions to avoid this problem are:</p><ul><li>downgrade StoRM Backend to v1.11.19 (<strong>recommended</strong>)</li><li>apply a workaround within MariaDB</li><li>install StoRM Backend v1.11.21 beta</li></ul><h3 id=downgrade-storm-backend-to-v11119>Downgrade StoRM Backend to v1.11.19</h3><p><strong>RECOMMENDED</strong>. It&rsquo;s the fastest and easy thing to do. The command:</p><pre><code>yum downgrade storm-backend-server
</code></pre><p>should ask you to install StoRM Backend v1.11.19. Confirm and restart the service:</p><pre><code>systemctl restart storm-backend-server
</code></pre><h3 id=apply-a-workaround-within-mariadb>Apply a workaround within MariaDB</h3><ol><li><p><strong>Populate</strong> <code>mysql.time_zone_name</code> <strong>table</strong></p><p>The <code>mysql.time_zone_name</code> table should be empty:</p><pre><code>MariaDB [mysql]&gt; SELECT * FROM mysql.time_zone_name;
Empty set (0.00 sec)
</code></pre><p>and global variable <code>time_zone</code> should be set to SYSTEM.</p><pre><code>MariaDB [mysql]&gt; SHOW GLOBAL VARIABLES LIKE 'time_zone';
+---------------+--------+
| Variable_name | Value  |
+---------------+--------+
| time_zone     | SYSTEM |
+---------------+--------+
1 row in set (0.00 sec)
</code></pre><p>We need to populate that table as follows:</p><pre><code>mysql_tzinfo_to_sql /usr/share/zoneinfo | mysql -uroot -pYOUR_MYSQL_ROOT_PASSWORD mysql
</code></pre></li><li><p><strong>Set</strong> <code>default_time_zone</code></p><p>Edit <code>/etc/my.cnf.d/server.conf</code> and add under <code>[mysql]</code> section add the following:</p><pre><code>default_time_zone = Europe/Rome
</code></pre><p>Or choose your proper <code>time_zone</code>.</p></li><li><p><strong>Restart MySQL</strong></p><pre><code>systemctl restart mariadb
</code></pre><p>And check new time zone value:</p><pre><code>MariaDB [(none)]&gt; SHOW GLOBAL VARIABLES LIKE 'time_zone';
+---------------+-------------+
| Variable_name | Value       |
+---------------+-------------+
| time_zone     | Europe/Rome |
+---------------+-------------+
1 row in set (0.00 sec)
</code></pre></li><li><p><strong>Restart StoRM Backend</strong></p><pre><code>systemctl restart storm-backend-server
</code></pre></li></ol><h3 id=install-storm-backend-v11121-beta>Install StoRM Backend v1.11.21 beta</h3><p>StoRM beta repository already contains a beta version of next StoRM v1.11.21 with this error fixed.
Of course beta repository is not a stable repo, so apply this in case of a testbed. We do not recommend use this rpms in a production behaviour.</p><p>Browse CentOS 7 Beta repository <a href=https://repo.cloud.cnaf.infn.it/service/rest/repository/browse/storm-rpm-beta/centos7/>here</a>.</p><ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5"><li><a href=/storm-docs/blog/2018/10/06/easy-documentation-with-docsy/ class="btn btn-primary"><span class=mr-1>←</span> Previous</a></li><a class="btn btn-primary disabled">Next <span class=ml-1>→</span></a></li></ul></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="StoRM users mailing list" aria-label="StoRM users mailing list"><a class=text-white target=_blank rel="noopener noreferrer" href=https://lists.infn.it/sympa/info/storm-users><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel="noopener noreferrer" href=https://github.com/italiangrid/storm><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank rel="noopener noreferrer" href=https://infn-storm-support.slack.com/><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="StoRM developers mailing list" aria-label="StoRM developers mailing list"><a class=text-white target=_blank rel="noopener noreferrer" href=https://lists.infn.it/sympa/info/storm-devel><i class="fa fa-envelope"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2021 INFN All Rights Reserved</small><p class=mt-2><a href=/storm-docs/about/>About us</a></p></div></div></div></footer></div><script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js integrity=sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49 crossorigin=anonymous></script><script src=https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js integrity=sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy crossorigin=anonymous></script><script src=/storm-docs/js/main.min.63db3e552bd0543be17ce4a79a18b744e9cb72256bec42b540e3ab0cd43722d0.js integrity="sha256-Y9s+VSvQVDvhfOSnmhi3ROnLciVr7EK1QOOrDNQ3ItA=" crossorigin=anonymous></script></body></html>